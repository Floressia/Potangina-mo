;/*FB_PKG_DELIM*/

__d("useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse",selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],type:"VestaGetUserInfoResponse",abstractKey:null};e.exports=a}),null);
__d("MWChatEncryptedBackupsNumericCodeErrorWrapper.react",["MWXColumn.react","MWXColumnItem.react","MWXText.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={inputWrapperErrorOnly:{paddingBottom:"x18d9i69",$$css:!0},outterWrapper:{minHeight:"x10sr9ya",$$css:!0},outterWrapperSmall:{minHeight:"x1h7t28c",$$css:!0}};function a(a){var b=a.children,d=a.error;a=a.inputSize;a=a===void 0?"large":a;var e=a==="large"?k.outterWrapper:k.outterWrapperSmall;return j.jsx(c("MWXColumn.react"),{xstyle:e,children:j.jsxs(c("MWXColumnItem.react"),{align:"center",paddingHorizontal:a==="large"?20:0,paddingTop:0,children:[j.jsx("div",{className:(h||(h=c("stylex")))(d!=null&&[k.inputWrapperErrorOnly]),children:b}),d!=null?j.jsx("div",{className:"x1o1nzlu x1y1aw1k x2b8uid",children:j.jsx(c("MWXText.react"),{color:"negative",testid:void 0,type:"body4",children:d})}):null]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncrypedBackupsNumericCodeValidation",[],(function(a,b,c,d,e,f){"use strict";var g=function(a){var b=/^[0-9]*$/;return b.test(a)};a=function(a,b){return a.length>b?!1:g(a)};b=function(a,b){return a.length!==b?!1:g(a)};f.numericCodeIsValid=a;f.numericCodeIsCompleted=b}),66);
__d("MWChatEncryptedBackupsNumericCodeInputInner.react",["BaseTextInput.react","FocusRegion.react","MWChatEncrypedBackupsNumericCodeValidation","focusScopeQueries","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useCallback,k=b.useEffect,l=b.useRef,m=b.useState,n=c("gkx")("24058"),o={input:{height:"x5yr21d",opacity:"xg01cxk",position:"x10l6tqk",start:"x17qophe",left:null,right:null,top:"x13vifvy",width:"xh8yej3",$$css:!0},testOpacity:{opacity:"x1ptxcow",$$css:!0}};function a(a){var b=a.extraProps.setFocus;a=a.props;var e=a["aria-label"],f=a.disabled,g=f===void 0?!1:f;a.enableMasking;var h=a.focusRegionId;f=a.inputMode;var p=a.onChange,q=a.onCompletionChange,r=a.size,s=a.testid;a=a.value;var t=m(a.length===r),u=t[0],v=t[1],w=l(null),x=l(g);t="mw-numeric-code-input-prevent-composer-focus-steal";var y=j(function(a){var b=d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(a,r);p(a);q!=null&&b!==u&&(v(b),q(b))},[u,p,q,r]);k(function(){var a=function(a){a.preventDefault()},b=w.current;b==null?void 0:b.addEventListener("selectstart",a);return function(){b==null?void 0:b.removeEventListener("selectstart",a)}},[]);k(function(){g&&b(!1)},[g,b]);k(function(){x.current!==g&&(x.current=g,g||d("FocusRegion.react").focusRegionById(h,d("focusScopeQueries").tabbableScopeQuery))},[g,h]);return i.jsx(c("BaseTextInput.react"),{"aria-label":e,autoComplete:"one-time-code",disabled:g,id:s!=null?s+"-"+t:t,inputMode:f,maxLength:r,onBlur:function(){b(!1)},onFocus:function(){b(!0)},onKeyDown:function(a){var b=a.keyCode;(b===37||b===38||b===39||b===40)&&(a.preventDefault(),a.stopPropagation())},onValueChange:function(a){a=a.toString();d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(a,r)&&y(a)},ref:w,testid:void 0,value:a,xstyle:[o.input,n&&o.testOpacity]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInputRenderer.react",["CometRow.react","CometRowItem.react","MWXText.react","react","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useState,m={input:{alignItems:"x6s0dn4",backgroundColor:"xljulmy",borderTopStartRadius:"xhk9q7s",borderTopEndRadius:"x1otrzb0",borderBottomEndRadius:"x1i1ezom",borderBottomStartRadius:"x1o6z2jb",borderTopStyle:"x1ejq31n",borderEndStyle:"xd10rxx",borderBottomStyle:"x1sy0etr",borderStartStyle:"x17r0tee",boxSizing:"x9f619",display:"x78zum5",height:"xng8ra",justifyContent:"xl56j7k",position:"x1n2onr6",width:"x1o817pb",$$css:!0},inputBox:{marginTop:"x1k70j0n",marginEnd:"x1w0mnb",marginBottom:"xzueoph",marginStart:"x1mnrxsn",$$css:!0},inputSmall:{height:"xaymia4",width:"x1bgwkul",$$css:!0},inputTiny:{height:"x1vqgdyp",width:"x10faclu",$$css:!0},focusRing:{boxShadow:"x18bame2",outline:"x1a2a7pz xvetz19",$$css:!0}};function a(a){var b=a.disabled,d=b===void 0?!1:b;b=a.enableMasking;var e=b===void 0?!1:b,f=a.hasFocus;b=a.inputSize;var g=b===void 0?"large":b,i=a.size;b=a.testid;b=b===void 0?"numeric-renderer":b;var n=a.value,o=function(a){return(n.length===a||n.length>a&&a===i-1)&&f};b=l(Array(i).fill(""));a=b[0];var p=b[1];k(function(){p(Array(i).fill().map(function(a,b){return n[b]!=null?e?"\u25cf":n[b]:""}))},[e,i,n]);return j.jsx(c("CometRow.react"),{align:"center",paddingHorizontal:0,paddingVertical:0,role:"group",spacing:0,children:a.map(function(a,b){return j.jsx(c("CometRowItem.react"),{xstyle:m.inputBox,children:j.jsx("div",{className:(h||(h=c("stylex")))(m.input,g==="small"&&m.inputSmall,g==="tiny"&&m.inputTiny,o(b)&&m.focusRing),"data-testid":void 0,children:e?j.jsx(c("MWXText.react"),{color:d?"disabled":"primary",type:"headlineEmphasized4",children:d?"\u25cf":a}):j.jsx(c("MWXText.react"),{color:d?"disabled":"primary",type:"headlineEmphasized1",children:a})})},b)})})}a.displayName=a.name+" [from "+f.id+"]";g.MWChatEncryptedBackupsNumericCodeInputRenderer=a}),98);
__d("MWChatEncryptedBackupsNumericCodeInput.react",["MWChatEncryptedBackupsNumericCodeInputInner.react","MWChatEncryptedBackupsNumericCodeInputRenderer.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useState;function a(a){var b=a.enableMasking,e=a.inputSize,f=a.size,g=a.testid;g=a.value;var h=j(!1),k=h[0];h=h[1];return i.jsxs("div",{className:"x1n2onr6",children:[i.jsx(d("MWChatEncryptedBackupsNumericCodeInputRenderer.react").MWChatEncryptedBackupsNumericCodeInputRenderer,{disabled:a.disabled,enableMasking:b,hasFocus:k,inputSize:e,size:f,testid:void 0,value:g}),i.jsx(c("MWChatEncryptedBackupsNumericCodeInputInner.react"),{extraProps:{setFocus:h},props:a})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useMWChatEncryptedBackupsNumericCode",["FocusRegion.react","MWChatEncrypedBackupsNumericCodeValidation","asyncToGeneratorRuntime","focusScopeQueries","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||(h=d("react"));var i=h.useState;function a(a){var e=a.checkPreviouslyInsertedCode,f=a.clearInputOnComplete,g=f===void 0?!1:f;f=a.enableMasking;var h=a.focusRegionId,j=a.inputSize,k=a.onChange,l=a.onComplete;a=i(!1);var m=a[0],n=a[1];a=i(!0);var o=a[0],p=a[1];a=i("");var q=a[0],r=a[1];a=function(a){p(!a)};var s=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsCompleted(a,j)){if(e!=null){var b=e.onCodeMismatch,c=e.previouslyInsertedCode;c=c===a;if(!c){b();return}}p(!0);n(!0);try{yield l(a),g&&r("")}catch(a){r("")}finally{n(!1)}}});return function(b){return a.apply(this,arguments)}}();return[{disabled:m,enableMasking:f,focusRegionId:h,onChange:function(a){var b=function(){d("MWChatEncrypedBackupsNumericCodeValidation").numericCodeIsValid(a,j)&&(r(a),k==null?void 0:k(a),c("promiseDone")(s(a)))};b()},onCompletionChange:a,size:j,value:q},{clearNumericInput:function(){return r("")},disabled:o,focusOnInput:function(){d("FocusRegion.react").focusRegionById(h,d("focusScopeQueries").tabbableScopeQuery)},isLoading:m,onPress:function(){c("promiseDone")(s(q))}}]}g.useMWChatEncryptedBackupsNumericCode=a}),98);
__d("LSFetchOTCEligibleEBDevicesV2",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return c.forEach(c.db.table(261).fetch(),function(a){return a["delete"]()})},function(a){return d[0]="",c.forEach(c.filter(c.db.table(261).fetch([[[d[0]]]]),function(a){return a.deviceId===d[0]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,20]))}),function(a){return a["delete"]()})},function(a){return c.db.table(261).add({deviceId:d[0],authorityLevel:c.i64.cast([0,20])})},function(a){return d[1]=new c.Map(),d[2]=c.toJSON(d[1]),c.storedProcedure(b("LSIssueNewTask"),"meb_fetch_otc_eligible_devices",c.i64.cast([0,50028]),d[2],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSFetchOTCEligibleEBDevicesV2StoredProcedure",["LSFetchOTCEligibleEBDevicesV2","cr:8709"],(function(a,b,c,d,e,f,g){function a(a){return c("LSFetchOTCEligibleEBDevicesV2")(a)}g["default"]=a}),98);
__d("useFetchOTCEligibleEBDevices",["FBLogger","LSAuthorityLevel","LSFactory","LSFetchOTCEligibleEBDevicesV2StoredProcedure","LSIntEnum","ReQL","ReQLSuspense","gkx","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b=j||d("react");var k=b.useCallback,l=b.useEffect,m=b.useRef,n=b.useState,o=c("gkx")("24064");function a(){var a=(h||(h=c("useReStore")))(),b=m(!1),e=n(!1),g=e[0],j=e[1];e=n(!1);var p=e[0],q=e[1];e=n(!1);var r=e[0],s=e[1];e=n(!1);var t=e[0],u=e[1];e=n([]);var v=e[0],w=e[1],x=d("ReQLSuspense").useArray(function(){return g?d("ReQL").fromTableAscending(a.table("encrypted_backups_otc_devices")):d("ReQL").empty()},[g,a],f.id+":49"),y=k(function(){return a.runInTransaction(function(a){return c("LSFetchOTCEligibleEBDevicesV2StoredProcedure")(c("LSFactory")(a))},"readwrite")},[a]),z=k(function(){q(!0),s(!1),c("promiseDone")(y(),function(){j(!0)},function(){c("FBLogger")("labyrinth_web").mustfix("Failed to fetch OTC eligible devices")})},[y]);l(function(){if(b.current!==!0)b.current=!0,z();else if(g){var a=x.length>0&&(i||(i=d("LSIntEnum"))).toNumber(x[0].authorityLevel)===c("LSAuthorityLevel").OPTIMISTIC;if(!a){q(!1);j(!1);a=x[0];a=a.deviceId==="-1";if(a){s(!0);c("FBLogger")("labyrinth_web").mustfix("Encrypted Backups OTC: Failed to fetch otc eligible devices.");return}a=x.filter(function(a){return(i||(i=d("LSIntEnum"))).toNumber(a.authorityLevel)!==c("LSAuthorityLevel").OPTIMISTIC&&a.deviceId!==""});w(a);u(a.length>0||o)}}},[y,g,x,z]);return{doesUserHaveOtcEligibleDevices:t,failedToFetchOtcDevices:r,isFetchOtcDevicesInFlight:p,otcEligibleDevices:v,triggerFetchOtcEligibleDevices:z}}g["default"]=a}),98);
__d("usePakeInitiatorManager",["FBLogger","PakeCpaceWasm","Promise","asyncToGeneratorRuntime","promiseDone","react","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;e=i||d("react");var j=e.useCallback,k=e.useEffect,l=e.useRef,m=c("requireDeferred")("establishPakeHandshakeAsInitiator").__setRef("usePakeInitiatorManager"),n=3e4;function a(a){var e=a.onGeneralFailure,f=a.onMaxAttemptsReached,g=a.onNoSessionExists,i=a.onSessionExpired,o=a.onSuccessfulSecretDecryption,p=a.onWrongOtc,q=a.timeout,r=q===void 0?n:q,s=a.clientType,t=c("useAsyncReStore")(),u=l(null),v=l(function(){}),w=l(function(){}),x=l(null),y=l(!1);k(function(){y.current===!1&&(y.current=!0,c("promiseDone")(d("PakeCpaceWasm").PakeCPaceWasm().then(function(a){x.current=a}),void 0,function(){c("FBLogger")("labyrinth_web").mustfix("PAKE: Error loading WASM module")}));return function(){var a;w.current();(a=u.current)==null?void 0:a["delete"]();v.current()}},[]);return{establishPakeHandshakeAsInitiator:j(function(a){return(h||(h=b("Promise"))).all([t,m.load()]).then(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=b[0];b=b[1];b=(yield b({clientType:s,onGeneralFailure:e,onMaxAttemptsReached:f,onNoSessionExists:g,onSessionExpired:i,onSuccessfulSecretDecryption:o,onWrongOtc:p,otc:a,pakeCpaceModule:x.current,storage:c,timeout:r}));c=b.pakeClient;var d=b.stopTimeout;b=b.unsubFromMessagesTable;u.current=c;v.current=d;w.current=b});return function(a){return c.apply(this,arguments)}}())},[s,t,e,f,g,i,o,p,r])}}g["default"]=a}),98);
__d("MWEncryptedBackupsInsertOTCStep.react",["fbt","EBSMGating","FBLogger","FocusRegion.react","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWEncryptedBackupsLocalStorageEntryEnum","MWEncryptedBackupsOTCEligibleDevicesContext.react","MWXColumn.react","MWXColumnItem.react","MWXDialogPageLegacy.react","MWXLink.react","MWXMultiStepDialogHeader.react","MWXSpinner.react","MWXText.react","PAKEClientTypeEnum","QPLUserFlow","focusScopeQueries","gkx","promiseDone","react","requireDeferred","useFetchOTCEligibleEBDevices","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","usePakeInitiatorManager","useReStore","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));b=j;var l=b.useCallback,m=b.useContext,n=b.useEffect,o=b.useRef,p=b.useState,q=c("requireDeferred")("MWEBUseLocalStorage").__setRef("MWEncryptedBackupsInsertOTCStep.react"),r=c("requireDeferred")("MWEncrypedBackupsSendOTCNotifications").__setRef("MWEncryptedBackupsInsertOTCStep.react"),s=c("requireDeferred")("MWEncryptedBackupsFetchBackupIds").__setRef("MWEncryptedBackupsInsertOTCStep.react"),t=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("MWEncryptedBackupsInsertOTCStep.react"),u=c("requireDeferred")("deserializeSecretsAndAddDevice").__setRef("MWEncryptedBackupsInsertOTCStep.react"),v="chat-encrypted-backups-dialog-layout-second-step",w=6,x=c("gkx")("23219"),y=c("gkx")("20861"),z=function(){return h._("__JHASH__lBlURV9iIv0__JHASH__")},A=function(){return h._("__JHASH__rIH_-tfv2x2__JHASH__")},B=function(){return h._("__JHASH__WypD50Gdi03__JHASH__")},C=function(){return h._("__JHASH__7uRJ4wtXcoz__JHASH__")},D=function(){return h._("__JHASH__XUu1h3R4qPj__JHASH__")},E=function(){return h._("__JHASH__ndaWq552FSK__JHASH__")},F=function(){return h._("__JHASH__WoNRZZnIdhP__JHASH__")};function a(a){var b=a.onComplete,e=a.onViewAllDevices;a=p(!1);var f=a[0],g=a[1],j=o(!1),G=o(!1),H=o(function(){}),I=o(function(){});a=p(null);var J=a[0],K=a[1],L=(i||(i=c("useReStore")))();a=c("useFetchOTCEligibleEBDevices")();var M=a.failedToFetchOtcDevices,N=a.isFetchOtcDevicesInFlight,O=a.otcEligibleDevices,P=a.triggerFetchOtcEligibleDevices;a=m(d("MWEncryptedBackupsOTCEligibleDevicesContext.react").MWEncryptedBackupsOTCEligibleDevicesContext);var Q=a.setFailedToFetchOtcDevices,R=a.setIsFetchOtcDevicesInFlight,S=a.setOtcEligibleDevices,T=c("useMWEBFlowSourceContext")();n(function(){return function(){H.current(),I.current()}},[]);n(function(){j.current===!1&&(j.current=!0,r.onReady(function(a){a=a.sendOTCNotifications;c("promiseDone")(a({db:L,onFailure:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_SEND_NOTIFICATION_FAILURE"),K(E())},otcEligibleDevices:[]}),function(a){H.current=a},function(){c("FBLogger")("labyrinth_web").mustfix("OTC: Send otc notifications sproc failed."),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_SEND_NOTIFICATION_FAILURE"),K(E())})})),R(N),S(O),Q(M)},[L,M,N,O,Q,R,S]);a=c("usePakeInitiatorManager")({clientType:c("PAKEClientTypeEnum").ENCRYPTED_BACKUPS,onGeneralFailure:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_API_FAILURE"),K(D()),G.current=!0,g(!1)},[]),onMaxAttemptsReached:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_MAX_ATTEMPTS_REACHED"),K(B()),G.current=!0,g(!1)},[]),onNoSessionExists:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_NO_SESSION"),K(A()),G.current=!0,g(!1)},[]),onSessionExpired:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SESSION_EXPIRED"),K(C()),G.current=!0,g(!1)},[]),onSuccessfulSecretDecryption:l(function(a){var e=a.decryptedSecret,f=a.initiatorId;c("promiseDone")(u.load(),function(a){c("promiseDone")(a({db:L,initiatorId:f,onAddDeviceFailure:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_ADD_DEVICE_FAILURE"),K(D()),G.current=!0,g(!1)},onAddDeviceFinish:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_ADD_DEVICE_FINISHED"),d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("EBSMGating").isBackendSetupSuccessfulForEBSM()}},event:d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent}),t.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:L,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))}),q.onReady(function(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)}),b(),g(!1),s.onReady(function(a){a=a.encryptedBackupsFetchBackupIds;a(L)["catch"](function(a){return c("FBLogger")("labyrinth_web").mustfix("OTC Restore: Error when fetching backup ids, %s",a)})})},secrets:e}),function(a){I.current=a})})},[L,b]),onWrongOtc:l(function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_INCORRECT_CODE"),K(z()),G.current=!0,g(!1)},[])});var U=a.establishPakeHandshakeAsInitiator;a=d("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode({focusRegionId:v,inputSize:w,onChange:function(){K()},onComplete:function(a){var b=T();c("QPLUserFlow").addAnnotations(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,{string:{restore_type:"one_time_code",source:b}});g(!0);c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SUBMIT");c("promiseDone")(U(a))}});var V=a[0];a=a[1];var W=a.clearNumericInput,X=a.focusOnInput;a=a.isLoading;n(function(){G.current&&(W(),G.current=!1)},[W]);var Y=c("useVisibilityObserver")({onVisible:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_SCREEN"),X()}});return k.jsxs(k.Fragment,{children:[k.jsx(c("MWXMultiStepDialogHeader.react"),{title:h._("__JHASH__mdY4-jjsr2I__JHASH__"),withCloseButton:!1,withoutBackButton:!0}),k.jsx(c("MWXDialogPageLegacy.react"),{callToActionGroupLayout:"expanded",includeFDSContentPadding_REMOVE_THIS_AFTER_CONTENT_PADDING_MIGRATION:!1,ref:Y,children:k.jsx("div",{className:"x2lwn1j",children:k.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingVertical:16,spacing:0,children:[k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx("div",{className:"x1l90r2v x2b8uid",children:k.jsx(c("MWXText.react"),{color:"secondary",type:"body3",children:h._("__JHASH__lzSAd4UfKCU__JHASH__")})})}),k.jsxs(c("MWXColumnItem.react"),{align:"center",children:[k.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:J,children:k.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:v,children:k.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},V,{disabled:a||f,testid:void 0}))})}),y&&J===D()?k.jsx("div",{className:"xwib8y2",children:k.jsx(c("MWXText.react"),{align:"center",color:"negative",type:"body4",children:h._("__JHASH__47yJJ8U23lB__JHASH__")})}):null,f?k.jsxs("div",{className:"x6s0dn4 x78zum5 xl56j7k x135pmgq xwib8y2",children:[k.jsx("div",{className:"x1sxyh0",children:k.jsx(c("MWXSpinner.react"),{color:x?"disabled":"blue",size:12})}),k.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"meta3",children:h._("__JHASH__zNLcSfOKcLf__JHASH__")})]}):null]}),k.jsx(c("MWXColumnItem.react"),{align:"center",children:k.jsx("div",{className:"x1y1aw1k",children:k.jsx(c("MWXLink.react"),{color:x?"primary":"highlight",disabled:f||a,display:"block",onClick:function(){W(),K(),e({onFetchOtcEligibleDevicesError:function(){K(F()),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_FETCH_OTC_ELIGIBLE_DEVICES_FAILURE"),P()},onResendCodeFailure:function(){K(E()),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESEND_NOTIFICATION_FAILURE")}}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_VIEW_ALL_DEVICES_CLICK")},rel:"noreferrer",children:k.jsx(c("MWXText.react"),{color:f?"disabled":"highlight",type:"button2",children:h._("__JHASH__UdIx77e_03V__JHASH__")})})})})]})})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWChatEBPinCodeVerifyIndicator.react",["fbt","MWXSpinner.react","MWXText.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){a=a.isMessenger;return j.jsxs("div",{className:"x6s0dn4 x78zum5 xl56j7k x135pmgq xwib8y2",children:[j.jsx("div",{className:"x1sxyh0",children:j.jsx(c("MWXSpinner.react"),{color:a?"disabled":"blue",size:12})}),j.jsx(c("MWXText.react"),{color:"secondary",testid:void 0,type:"meta3",children:h._("__JHASH__sqvt0agiqDI__JHASH__")})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWEBPinCodeSize",[],(function(a,b,c,d,e,f){"use strict";a=6;f.EB_PIN_CODE_SIZE=a}),66);
__d("useMWChatEncryptedBackupsPinCodeRestore",["CometRelay","EBSMGating","JSResourceForInteraction","MWChatEncryptedBackupsLogging","MWChatEncryptedBackupsQPLEvents","MWEBODSEntityName.enum","MWEBPinCodeSize","MWEBUpsellDismissedEnum.facebook","MWEncryptedBackupsLocalStorageEntryEnum","QPLUserFlow","asyncToGeneratorRuntime","promiseDone","react","requireDeferred","useLabyrinthLogging","useMWChatEncryptedBackupsAddDevice","useMWChatEncryptedBackupsNumericCode","useMWEBFlowSourceContext","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;e=i||d("react");var j=e.useCallback,k=e.useEffect,l=e.useRef,m=e.useState,n=c("requireDeferred")("MWEBUseLocalStorage").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),o=c("requireDeferred")("MWEncryptedBackupsSharedState").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),p=c("requireDeferred")("mwEBGetPINSecretFromVesta").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),q=c("requireDeferred")("updateUpsellsStateInRelayStore").__setRef("useMWChatEncryptedBackupsPinCodeRestore"),r=c("JSResourceForInteraction")("MWEncryptedBackupsHsmFleetMigrationGated").__setRef("useMWChatEncryptedBackupsPinCodeRestore");function a(a){var e=a.clientID,f=a.focusRegionId,g=a.onSubmitPin,i=a.onSubmitPinFailure,s=a.onVestaComplete,t=d("CometRelay").useRelayEnvironment();a=m(!1);var u=a[0],v=a[1];a=m(!1);var w=a[0],x=a[1];a=m(!1);var y=a[0],z=a[1],A=l(!1);a=d("useLabyrinthLogging").useLabyrinthLoggingFlow();var B=a.startFlow,C=(h||(h=c("useReStore")))(),D=c("useMWEBFlowSourceContext")();a=m(!1);var E=a[0],F=a[1];a=c("useMWChatEncryptedBackupsAddDevice")({hsmFleetMigrationResetPIN:j(function(a){c("promiseDone")(r.load().then(function(b){b({db:C,environment:t,pinCode:a,startFlow:B})}))},[C,t,B]),onComplete:j(function(){var a;c("QPLUserFlow").addPoint((a=d("MWChatEncryptedBackupsQPLEvents")).restoreDeviceAuthQplEvent,"add_device_success");c("QPLUserFlow").addPoint(a.restoreQplEvent,"restore_auth_finished_and_dismissed");o.onReady(function(a){a=a.upsertEBSharedStateEntry;c("promiseDone")(a({db:C,stateKey:c("MWEncryptedBackupsLocalStorageEntryEnum").ENCRYPTED_BACKUPS_RESTORED_SUCCESSFULLY}))});n.onReady(function(a){var b=a.mwEBCreateLocalStorageEntry;a=a.mwEBDeleteLocalStorageEntry;b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION);b(c("MWEncryptedBackupsLocalStorageEntryEnum").MW_EB_HAS_RESTORED_IN_CURRENT_SESSION_2);a(c("MWEncryptedBackupsLocalStorageEntryEnum").EBSM_CORRUPTION_WIPE)});d("MWChatEncryptedBackupsLogging").endSuccess({annotations:{bool:{is_backend_setup:d("EBSMGating").isBackendSetupSuccessfulForEBSM()}},event:a.restoreQplEvent});d("MWChatEncryptedBackupsLogging").endSuccess({event:a.restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH});s();F(!1)},[C,s]),onFailure:j(function(a){i==null?void 0:i(),A.current=!0,x(!0),F(!1),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,a),d("MWChatEncryptedBackupsLogging").endFailure({errorName:a,event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("promiseDone")(q.load(),function(a){a({environment:t,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})})},[t,i]),onInvalidRecoveryCode:j(function(){i==null?void 0:i(),A.current=!0,x(!0),F(!1),d("MWChatEncryptedBackupsLogging").endFailure({errorName:"pin_code_restore_wrong_recovery_code",event:d("MWChatEncryptedBackupsQPLEvents").restoreDeviceAuthQplEvent,odsEntityName:c("MWEBODSEntityName.enum").MW_EB_PIN_RESTORE_AUTH}),c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"pin_code_restore_wrong_recovery_code"),c("promiseDone")(q.load(),function(a){a({environment:t,updateValue:d("MWEBUpsellDismissedEnum.facebook").MWEBUpsellDismissedStateEnum.NOT_DISMISSED})})},[t,i])});var G=a[0];a=d("useMWChatEncryptedBackupsNumericCode").useMWChatEncryptedBackupsNumericCode({enableMasking:!0,focusRegionId:f,inputSize:d("MWEBPinCodeSize").EB_PIN_CODE_SIZE,onChange:function(){x(!1),z(!1),v(!1)},onComplete:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield p.load());yield b({addDevice:G,clientID:e,environment:t,getSourceFromContext:D,onSubmitPin:g,onSubmitPinFailure:i,pinCode:a,setIsInProgress:F,setIsPinCodeIncorrect:v,setIsVestaError:z,startFlow:B})});function c(b){return a.apply(this,arguments)}return c}()});f=a[0];a=a[1];var H=a.clearNumericInput,I=a.disabled;a=a.focusOnInput;k(function(){A.current&&(H(),A.current=!1)},[H]);return{focusOnInput:a,inputProps:f,isDisabled:(a=I)!=null?a:!1,isInProgress:E,isLabyrinthError:w,isPinCodeIncorrect:u,isVestaError:y}}g.useMWChatEncryptedBackupsPinCodeRestore=a}),98);
__d("MWChatEncryptedBackupsPinCodeRestoreStep.react",["fbt","FocusRegion.react","JSResourceForInteraction","MWChatEBPinCodeVerifyIndicator.react","MWChatEncryptedBackupsNumericCodeErrorWrapper.react","MWChatEncryptedBackupsNumericCodeInput.react","MWChatEncryptedBackupsQPLEvents","MWChatEncryptedBackupsVestaUserInfoContext.react","MWXColumn.react","MWXColumnItem.react","MWXDialogPageLegacy.react","MWXLink.react","MWXMultiStepDialogHeader.react","MWXText.react","QPLUserFlow","focusScopeQueries","gkx","lazyLoadComponent","promiseDone","react","useEncryptedBackupsQplImpressionRef","useMWChatEncryptedBackupsPinCodeRestore","xplatToDOMRef"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext,l=b.useEffect,m=c("gkx")("23219"),n=c("JSResourceForInteraction")("MWChatEncryptedBackupsPinCodeBlockedStep.react").__setRef("MWChatEncryptedBackupsPinCodeRestoreStep.react"),o="chat-encrypted-backups-dialog-layout-restore-step";function a(a){var b=a.clientID,e=a.onChooseOtc,f=a.onClose,g=a.onComplete,i=a.onForgotPin;a=a.shouldShowForgotButton;a=a===void 0?!0:a;b=d("useMWChatEncryptedBackupsPinCodeRestore").useMWChatEncryptedBackupsPinCodeRestore({clientID:b,focusRegionId:o,onVestaComplete:g});var p=b.focusOnInput,q=b.inputProps,r=b.isInProgress,s=b.isLabyrinthError,t=b.isPinCodeIncorrect;b=b.isVestaError;var u=h._("__JHASH__CPDJhi3l1S1__JHASH__"),v=k(d("MWChatEncryptedBackupsVestaUserInfoContext.react").VestaUserInfoContext),w=v.attemptsRemaining;v=v.loginTimeoutRemainingSecs;var x=w===0,y=x||v!=null&&v>0,z=c("useEncryptedBackupsQplImpressionRef")(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_SCREEN",function(){p(),A!=null&&c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_OPTION_DISPLAYED_RESTORE_SCREEN")});a=a?j.jsx(c("MWXLink.react"),{color:m?"primary":"highlight",disabled:y||r,display:"block",onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"PIN_CODE_RESTORE_FORGOT_PIN_CLICK"),i()},rel:"noreferrer",testid:void 0,children:j.jsx(c("MWXText.react"),{color:y||r?"disabled":"highlight",type:"button2",children:h._("__JHASH__UY_FDJp7Rzt__JHASH__")})}):null;var A=e!==null?j.jsx(c("MWXLink.react"),{color:m?"primary":"highlight",disabled:y||r,display:"block",onClick:function(){c("QPLUserFlow").addPoint(d("MWChatEncryptedBackupsQPLEvents").restoreQplEvent,"OTC_RESTORE_USE_ONE_TIME_CODE_CLICK"),e()},rel:"noreferrer",testid:void 0,children:j.jsx(c("MWXText.react"),{color:y||r?"disabled":"highlight",type:"button2",children:h._("__JHASH__rIytKXj5Yr0__JHASH__")})}):null;a=A!=null?A:a;var B=h._("__JHASH__6pjlJMQcqkh__JHASH__"),C=c("lazyLoadComponent")(n);y=y?j.jsx(C,{attemptsRemaining:w,loginTimeoutRemainingSecs:v,onClose:f,onComplete:g}):j.jsx(c("MWXDialogPageLegacy.react"),{callToActionGroupLayout:"expanded",includeFDSContentPadding_REMOVE_THIS_AFTER_CONTENT_PADDING_MIGRATION:!1,ref:d("xplatToDOMRef").xplatToDOMRef(z),children:j.jsxs(c("MWXColumn.react"),{align:"center",paddingHorizontal:16,paddingVertical:16,spacing:0,children:[j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx(c("MWXText.react"),{align:"center",color:"secondary",type:"body3",children:j.jsx("div",{className:"x1l90r2v x2b8uid",children:u})})}),j.jsxs(c("MWXColumnItem.react"),{align:"center",children:[j.jsx(c("MWChatEncryptedBackupsNumericCodeErrorWrapper.react"),{error:t?h._("__JHASH__TG8l6XqQAul__JHASH__"):s||b?h._("__JHASH__oI6Lha5PMTv__JHASH__"):void 0,children:j.jsx(d("FocusRegion.react").FocusRegion,{autoFocusQuery:d("focusScopeQueries").tabbableScopeQuery,id:o,children:j.jsx(c("MWChatEncryptedBackupsNumericCodeInput.react"),babelHelpers["extends"]({},q,{disabled:v!=null||x||r,testid:void 0}))})}),r?j.jsx(c("MWChatEBPinCodeVerifyIndicator.react"),{isMessenger:m}):null]}),j.jsx(c("MWXColumnItem.react"),{align:"center",children:j.jsx("div",{className:"x1y1aw1k",children:a})})]})});l(function(){c("promiseDone")(n.load())},[]);return j.jsxs(j.Fragment,{children:[j.jsx(c("MWXMultiStepDialogHeader.react"),{title:B,withCloseButton:!1,withoutBackButton:!0}),y]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useMWChatEncryptedBackupsVestaUserInfo",["CometRelay","useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c;a=a.vestaGetUserInfoResponse$key;a=d("CometRelay").useFragment(h!==void 0?h:h=b("useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse.graphql"),a);return{attemptsRemaining:(c=a==null?void 0:a.attempts_remaining)!=null?c:null,isRegistered:(c=a==null?void 0:a.is_registered)!=null?c:null,loginTimeoutRemainingSecs:(c=a==null?void 0:a.login_timeout_remaining_secs)!=null?c:null}}g["default"]=a}),98);
__d("MWEBFlowSourceContextProvider.react",["MWEBFlowSourceContext","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useMemo;function a(a){var b=a.children,d=a.source;a=j(function(){return{source:d}},[d]);return i.jsx(c("MWEBFlowSourceContext").Provider,{value:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);